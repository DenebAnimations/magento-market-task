(function(){"use strict";var e={9906:function(e,t,n){var a=n(9242),i=n(3396);function r(e,t,n,a,r,o){const s=(0,i.up)("MainPage"),c=(0,i.up)("n-message-provider");return(0,i.wg)(),(0,i.j4)(c,{placement:"bottom"},{default:(0,i.w5)((()=>[(0,i.Wm)(s)])),_:1})}const o={class:"suspense"},s={class:"sidebar"},c={key:0,class:"products-container"},l=(0,i._)("h1",null,"Select a category to view products",-1),u=[l],d={class:"overlay-center"};function p(e,t,n,a,r,l){const p=(0,i.up)("AppHeader"),g=(0,i.up)("NavigationMenu"),h=(0,i.up)("BindableBreadcrumb"),m=(0,i.up)("ProductsGrid"),f=(0,i.up)("n-spin"),y=(0,i.up)("ProductPage"),v=(0,i.up)("n-modal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(p,{title:"Magento Market"}),((0,i.wg)(),(0,i.j4)(i.n4,null,{fallback:(0,i.w5)((()=>[(0,i._)("div",d,[(0,i.Wm)(f,{size:"large"})])])),default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i._)("div",s,[(0,i.Wm)(g,{onChange:l.navSelectionChanged,onPathChange:l.navPathChanged},null,8,["onChange","onPathChange"])]),((0,i.wg)(),(0,i.iD)("div",{class:"content",key:r.selected},[(0,i.Wm)(h,{class:"path",items:r.nav},null,8,["items"]),""===r.selected?((0,i.wg)(),(0,i.iD)("div",c,u)):((0,i.wg)(),(0,i.j4)(m,{key:JSON.parse(r.selected).key,category:r.selected,onButtonClick:l.productsButtonClick,onCardClick:l.productsCardClick,pageSizeProp:r.globalPageSize,onPageSizeChanged:l.globalPageSizeChanged},null,8,["category","onButtonClick","onCardClick","pageSizeProp","onPageSizeChanged"]))]))])])),_:1})),(0,i.Wm)(v,{class:"modal-card",show:r.show_product,"onUpdate:show":t[0]||(t[0]=e=>r.show_product=e),preset:"card",bordered:!1},{default:(0,i.w5)((()=>[(0,i.Wm)(y)])),_:1},8,["show"])],64)}var g=n(7139);const h={class:"header"};function m(e,t,n,a,r,o){const s=(0,i.up)("MaterialIcon"),c=(0,i.up)("n-icon"),l=(0,i.up)("n-button"),u=(0,i.up)("n-space");return(0,i.wg)(),(0,i.iD)("div",h,[(0,i._)("h1",null,(0,g.zw)(n.title),1),(0,i.Wm)(u,{size:"small"},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{class:"button",strong:"",quaternary:"",round:"",onClick:o.cartOpen},{icon:(0,i.w5)((()=>[(0,i.Wm)(c,{size:"24"},{default:(0,i.w5)((()=>[(0,i.Wm)(s,{icon:"shopping_cart"})])),_:1})])),_:1},8,["onClick"]),(0,i.Wm)(l,{class:"button",strong:"",quaternary:"",round:"",onClick:o.profileOpen},{icon:(0,i.w5)((()=>[(0,i.Wm)(c,{size:"24"},{default:(0,i.w5)((()=>[(0,i.Wm)(s,{icon:"person"})])),_:1})])),_:1},8,["onClick"])])),_:1})])}var f=n(1260),y=n(5393),v=n(4786),_=n(8831);const k={class:"material-symbols-rounded"};function w(e,t,n,a,r,o){return(0,i.wg)(),(0,i.iD)("span",k,(0,g.zw)(n.icon),1)}var C={name:"MaterialIcon",props:{icon:String}},b=n(89);const S=(0,b.Z)(C,[["render",w]]);var z=S,P={name:"AppHeader",setup(){const e=(0,f.U)();return{infoMsg(t){e.info(t)}}},methods:{cartOpen(){this.infoMsg("Cart opened")},profileOpen(){this.infoMsg("Profile opened")}},components:{NButton:y.ZP,NIcon:v.g,NSpace:_.Z,MaterialIcon:z},props:{title:String}};const O=(0,b.Z)(P,[["render",m]]);var N=O,W=n(553),Z=n(7541);function U(e,t,n,a,r,o){const s=(0,i.up)("n-menu");return(0,i.wg)(),(0,i.j4)(s,{accordion:"",options:r.menu,"expanded-keys":r.expanded_keys,value:r.selected,"onUpdate:value":o.menuOnUpdated,"onUpdate:expandedKeys":o.menuOnKeysUpdated},null,8,["options","expanded-keys","value","onUpdate:value","onUpdate:expandedKeys"])}var M=n(2482);class B{constructor(){(0,M.Z)(this,"BASE_URL","https://venia.magento.com/graphql"),(0,M.Z)(this,"FALLBACK_URL","https://magento.nightskystudio.workers.dev/"),(0,M.Z)(this,"CORS",!1),(0,M.Z)(this,"Options",{method:"POST"})}setCors(e){return this.CORS=e,this}async get_categories(e="",t=10,n=1){if(this.CORS){const a=`{ categories( ${""!=e?`filters: ${e} `:""}pageSize: ${t} currentPage: ${n} ) { total_count items { uid level name path children_count children { uid level name path children_count children { uid level name path children_count } } } page_info { current_page page_size total_pages } } }`;let i=await fetch(this.BASE_URL,{...this.Options,body:JSON.stringify({query:a})});return await i.json()}{let a=await fetch(this.FALLBACK_URL,{...this.Options,body:JSON.stringify({query:"get_categories",params:{filters:e,page_size:t,current_page:n}})});return await a.json()}}async get_products(e="",t=100,n=1){if(this.CORS){const a=`{ products(${""!=e?`filter: ${e}`:""} pageSize: ${t} currentPage: ${n} ) { total_count items { uid name sku image { url label } description { html } stock_status price_range { minimum_price { regular_price { value currency } } } } page_info { current_page page_size total_pages } } }`;let i=await fetch(this.BASE_URL,{...this.Options,body:JSON.stringify({query:a})});return await i.json()}{let a=await fetch(this.FALLBACK_URL,{...this.Options,body:JSON.stringify({query:"get_products",params:{filters:e,page_size:t,current_page:n}})});return await a.json()}}}const j=(new B).setCors(!1);var $=n(4764);const L=e=>()=>(0,i.h)((0,i.Wm)(v.g,{size:"24"},null),null,{default:()=>(0,i.h)(e)}),A={label:"Categories",key:JSON.stringify({label:"Home",key:"home"}),icon:L((0,i.Wm)(z,{icon:"menu"},null))};function H(e){let t=[];if(!(e.children_count>0))return{label:e.name,key:JSON.stringify({label:e.name,key:e.uid})};for(var n=0;n<e.children_count;n++)t.push({label:e.children[n].name,key:JSON.stringify({label:e.children[n].name,key:e.children[n].uid}),children:H(e.children[n])});return t}function x(e,t,n=[]){if(e.key==t)return n;if(e.children)for(var a=0;a<e.children.length;a++){let i=x(e.children[a],t,[...n,e.children[a]]);if(i)return i}return null}function J(e,t){let n=[e[0],...x(e[0],t)];if(n){let e=[];for(var a=0;a<n.length;a++)e.push(n[a].key);return e}}var D={name:"NavigationMenu",async setup(){var e=await j.get_categories();return{default_category:e.data.categories.items[0]}},methods:{menuOnUpdated(e){this.$emit("change",e),this.selected=e,this.$emit("pathChange",J(this.menu,e)),window.innerWidth<960&&(this.expanded_keys=[])},menuOnKeysUpdated(e){this.expanded_keys=e}},mounted(){this.menu=[{...A,children:[{key:"divider-1",type:"divider"},...H(this.default_category)]}]},watch:{expanded_keys(e,t){e.length>0&&(e.length<t.length?this.selected=t.filter((t=>!e.includes(t)))[0]:this.selected=e.filter((e=>!t.includes(e)))[0],this.selected!=JSON.stringify({label:"Home",key:"home"})&&(this.$emit("change",this.selected),this.$emit("pathChange",J(this.menu,this.selected))))}},data(){return{selected:"",expanded_keys:[],menu:[{...A,children:[{label:"Loading...",key:"loading"}]},{key:"divider-1",type:"divider"}]}},components:{NMenu:$.Z}};const I=(0,b.Z)(D,[["render",U]]);var K=I;function R(e,t,n,a,r,o){const s=(0,i.up)("n-breadcrumb-item"),c=(0,i.up)("n-breadcrumb");return(0,i.wg)(),(0,i.j4)(c,{separator:n.separator},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.items,(e=>((0,i.wg)(),(0,i.j4)(s,{key:e.key,clickable:!1},{default:(0,i.w5)((()=>[(0,i.Uk)((0,g.zw)(e.label),1)])),_:2},1024)))),128))])),_:1},8,["separator"])}var T=n(344),q=n(6227),E={name:"BindableBreadcrumb",props:{items:{type:Array,default:()=>[{}]},separator:{type:String,default:"/"}},components:{NBreadcrumb:T.ZP,NBreadcrumbItem:q.Z}};const F=(0,b.Z)(E,[["render",R]]);var Y=F;const G={key:0,class:"products"},Q={key:1,class:"line"},V={class:"line"};function X(e,t,n,a,r,o){const s=(0,i.up)("ProductCard"),c=(0,i.up)("n-spin"),l=(0,i.up)("n-pagination");return(0,i.wg)(),(0,i.iD)(i.HY,null,[r.loading?((0,i.wg)(),(0,i.iD)("div",Q,[(0,i.Wm)(c,{size:"large"})])):((0,i.wg)(),(0,i.iD)("div",G,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.productCards,(e=>((0,i.wg)(),(0,i.j4)(s,{key:e.uid,title:e.name,price:{value:e.price_range.minimum_price.regular_price.value,currency:e.price_range.minimum_price.regular_price.currency},sku:e.sku,image:e.image.url,stock:"IN_STOCK"!==e.stock_status,onClick:o.cardClick},null,8,["title","price","sku","image","stock","onClick"])))),128))])),(0,i._)("div",V,[(0,i.Wm)(l,{page:r.page,"page-count":r.pageCount,"page-size":a.pageSize,"show-size-picker":"","page-sizes":[8,16,32,48,64],size:"medium","onUpdate:page":o.pageChanged,"onUpdate:pageSize":o.pageSizeChanged},null,8,["page","page-count","page-size","onUpdate:page","onUpdate:pageSize"])])],64)}const ee={class:"placeholder"},te={class:"card-footer"},ne=(0,i.Uk)(" Out of stock ");function ae(e,t,n,r,o,s){const c=(0,i.up)("n-spin"),l=(0,i.up)("n-image"),u=(0,i.up)("MaterialIcon"),d=(0,i.up)("n-icon"),p=(0,i.up)("n-button"),h=(0,i.up)("n-card");return(0,i.wg)(),(0,i.j4)(a.uT,{appear:""},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{class:"card",title:n.title,size:"small",hoverable:"",borderless:""},{cover:(0,i.w5)((()=>[(0,i.Wm)(a.uT,{appear:""},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{src:n.image,style:{width:"100%"},"show-toolbar":!1},{placeholder:(0,i.w5)((()=>[(0,i._)("div",ee,[(0,i.Wm)(c,{size:"large"})])])),_:1},8,["src"])])),_:1})])),action:(0,i.w5)((()=>[(0,i._)("div",te,[n.stock?((0,i.wg)(),(0,i.j4)(p,{key:1,class:"card-button",strong:"","icon-placement":"left",type:"default",disabled:""},{icon:(0,i.w5)((()=>[(0,i.Wm)(d,{size:"24"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{icon:"block"})])),_:1})])),default:(0,i.w5)((()=>[ne])),_:1})):((0,i.wg)(),(0,i.j4)(p,{key:0,class:"card-button",strong:"","icon-placement":"right",type:"primary"},{icon:(0,i.w5)((()=>[(0,i.Wm)(d,{size:"24"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{icon:"add_shopping_cart"})])),_:1})])),default:(0,i.w5)((()=>[(0,i.Uk)(" "+(0,g.zw)(n.price.value)+" "+(0,g.zw)(n.price.currency),1)])),_:1}))])])),_:1},8,["title"])])),_:1})}var ie=n(9522),re=n(4189),oe={name:"ProductCard",components:{NButton:y.ZP,NCard:ie.ZP,NIcon:v.g,NImage:re.Z,NSpin:W.Z,MaterialIcon:z},props:{title:String,price:{value:Number,currency:String},sku:String,image:String,stock:Boolean}};const se=(0,b.Z)(oe,[["render",ae]]);var ce=se,le=n(2177),ue={name:"ProductsGrid",emits:["buttonClick","cardClick","pageSizeChanged"],props:{category:{label:String,key:String},pageSizeProp:{type:Number,default:8}},setup(e){return{pageSize:e.pageSizeProp}},async mounted(){this.pageSizeChanged(this.pageSizeProp),this.pageChanged(1)},beforeUnmount(){this.productCards=[]},data(){return{loading:!1,productCards:[],page:1,pageCount:1}},methods:{async update(e,t){if(this.loading)return;this.loading=!0,t!=this.pageSize&&(this.pageCount=1,this.$emit("pageSizeChanged",t)),this.page=e,this.pageSize=t;let n=JSON.parse(this.category).key,a=await j.get_products(`{ category_uid: { eq: "${n}" } }`,this.pageSize,this.page);return this.pageCount=a.data.products.page_info.total_pages,this.loading=!1,a.data.products.items},async pageSizeChanged(e){this.productCards=await this.update(1,e)},async pageChanged(e){this.productCards=await this.update(e,this.pageSize)},cardClick(e){e.target instanceof HTMLDivElement&&this.$emit("cardClick",e),e.target instanceof HTMLButtonElement&&this.$emit("buttonClick",e)}},components:{ProductCard:ce,NPagination:le.Z,NSpin:W.Z}};const de=(0,b.Z)(ue,[["render",X]]);var pe=de;const ge=(0,i._)("p",null,"Product page",-1),he=[ge];function me(e,t,n,a,r,o){return(0,i.wg)(),(0,i.iD)("div",null,he)}var fe={name:"ProductPage",props:{},components:{}};const ye=(0,b.Z)(fe,[["render",me]]);var ve=ye,_e={name:"MainPage",setup(){const e=(0,f.U)();return{successMsg(t){e.success(t)}}},data(){return{selected:"",show_product:!1,globalPageSize:8,nav:[{label:"Home",key:"home"}]}},methods:{titleClicked(){console.log("Title clicked"),this.selected="",this.navSelectionChanged(JSON.stringify({label:"Home",key:"home"}))},globalPageSizeChanged(e){console.log("globalPageSizeChanged",e),this.globalPageSize=e},productsCardClick(e){console.log(e),this.show_product=!0},productsButtonClick(){this.successMsg("Product added to cart"),this.cart++},navSelectionChanged(e){this.selected=e},navPathChanged(e){this.nav=e.length>1&&e[0]==JSON.stringify({label:"Home",key:"home"})?e.map((e=>{let{label:t,key:n}=JSON.parse(e);return{label:t,key:n}})):this.nav}},components:{NSpin:W.Z,NModal:Z.Z,AppHeader:N,NavigationMenu:K,BindableBreadcrumb:Y,ProductsGrid:pe,ProductPage:ve}};const ke=(0,b.Z)(_e,[["render",p]]);var we=ke,Ce=n(1407),be={name:"App",components:{MainPage:we,NMessageProvider:Ce.Z}};const Se=(0,b.Z)(be,[["render",r]]);var ze=Se;(0,a.ri)(ze).mount("#app")}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,i,r){if(!a){var o=1/0;for(u=0;u<e.length;u++){a=e[u][0],i=e[u][1],r=e[u][2];for(var s=!0,c=0;c<a.length;c++)(!1&r||o>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[c])}))?a.splice(c--,1):(s=!1,r<o&&(o=r));if(s){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,r,o=a[0],s=a[1],c=a[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var u=c(n)}for(t&&t(a);l<o.length;l++)r=o[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},a=self["webpackChunkmagento_market"]=self["webpackChunkmagento_market"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(9906)}));a=n.O(a)})();
//# sourceMappingURL=app.805fa0b7.js.map